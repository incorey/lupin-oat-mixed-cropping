<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="25-results_files/libs/clipboard/clipboard.min.js"></script>
<script src="25-results_files/libs/quarto-html/quarto.js"></script>
<script src="25-results_files/libs/quarto-html/popper.min.js"></script>
<script src="25-results_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="25-results_files/libs/quarto-html/anchor.min.js"></script>
<link href="25-results_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="25-results_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="25-results_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="25-results_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="25-results_files/libs/bootstrap/bootstrap-c0367b04c37547644fece4185067e4a7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="results" class="level1">
<h1>Results</h1>
<p>Amongst all attributes analysed, the following response variables exhibited significant effects of mixed cropping compared with pure stands: Plant growth stage at harvest of NLL and oat, cereal leaf beetle of oats, ears appearance in oats, height of oats in mid May, soil cover, weed volumes in NLL and oats (<a href="#tbl_onfield">Table 5</a>), oats and NLL protein yield, partial protein overyielding and the (partial) land equivalent ratios (Figure 5), as well as thousand kernel weight, hectolitre weight and protein content of oats (<a href="#tbl_offfield">Table 6</a>). In contrast, mixed cropping showed no effect on the following attributes: Lodging of NLLs, plant heights of NLL, NLL plant developmental stage at flowering, plant height of oat in June and July, tiller number of oats, crown rust of oats (<em>Puccinia coronata</em>), anthracnose of NLL (<em>Colletotrichum lupini</em>), NLL determinism, thousand kernel weight of NLL grains, protein content of NLL grains, and total protein overyielding. The following four subchapters will shed light on the response variables listed above, divided into plant development, plant health, productivity and crop quality. The full analytical output is provided as Appendix A in the supplemental materials.</p>
<section id="field-effects-of-mixed-cropping" class="level2">
<h2 class="anchored" data-anchor-id="field-effects-of-mixed-cropping">Field effects of mixed cropping</h2>
<p>The reported significant effects in the following two subchapters on plant development and plant health are summarised in <a href="#tbl_onfield">Table 5</a>.</p>
<section id="plant-development" class="level3">
<h3 class="anchored" data-anchor-id="plant-development">Plant development</h3>
<p>The mixed stands covered the soil on average 19.8 days earlier than pure oats, whereas there was no significant difference between the soil coverage in pure and mixed stands of all NLL varieties. The individual NLL varieties differed moderately, but significantly (p &lt; 0.05), in terms of the date, when the soil was covered: On average, across both years and sites, Lunabor established a full canopy cover 3 days sooner than Jowisz, and 7 days sooner than Probor. In year 2022 overall, the soil cover was established 22 days sooner than in year 2023 (p &lt; 0.001).</p>
<p>No difference in NLL flowering (BBCH 65) could be observed between pure and mixed stands. However, the oat ears emerged significantly later in mixture than in pure stands. The strongest effect could be observed in Troll and Lion with a two days delay (p &lt; 0.05), followed by Lion with a single day later onset of ears emergence in mixed, compared with pure stands, respectively. For the plant mutual maturity (BBCH growth stage 89) in mixed stands, the linear mixed-effect models showed for the oat crop an average delay of 2.4 BBCH stages compared with the growth stage of the NLL crop. However, this effect was more prominent in the year 2023, whereas the effect of the year 2022 resulted in near-coincidental maturity, i.e.&nbsp;in 2022, both crops were ripe during the same days, whereas in 2023 there was a slight delay of the oat crop. The NLLs determinism was not affected by mixed cropping and the indeterminacy was low, ranging from 1 to 3%.</p>
<p>Amongst the recorded time series of plant heights spanning between May and July, only the oat height in May differed between pure and mixed stands, where Bison was on average 9.9 cm, Lion 8.7 cm and Troll 6.6 cm shorter in mixed than in pure stands (p &lt; 0.001). In contrast, in June and July, there was no difference between the NLL and oat plant heights in mixed compared with pure stands. Likewise, the time series of lodging did not show any mixed cropping effect in NLLs. In the oat crops, there was no lodging at all. The number of oat tillers was also not affected by mixed cropping. However, the site Reckenholz showed a 10% higher number of oat tillers across both pure and mixed stands (0.24 more tillers per plant, p &lt; 0.001).</p>
</section>
<section id="plant-health-and-weed-pressure" class="level3">
<h3 class="anchored" data-anchor-id="plant-health-and-weed-pressure">Plant health and weed pressure</h3>
<p>Amongst the scored pests and diseases, only crown rust (<em>Puccinia coronata</em>) and cereal leaf beetle (<em>Oulema ssp.</em>) population had been recorded to exceed the interference threshold in more than 1% of all recorded data points <span class="citation" data-cites="zotero-498">[@zotero-498]</span>. The other pests and diseases were not statistically analysed, since their occurrence was below 1%.</p>
<p>The cereal leaf beetles showed higher incidences on pure stands of Lion and Troll (p &lt; 0.05), compared with their respective mixed stands, whereas the cereal leaf beetle incidence did not differ significantly between pure and mixed stands of Bison. The changes reported in <a href="#tbl_onfield">Table 5</a> correspond to a reduction of the cereal leaf beetle incidence of 41% for Lion and 46% for Troll when mixed with NLLs (p &lt; 0.05). The linear mixed-effect models showed a strong year effect exceeding the mixed cropping effect (p &lt; 0.001): In 2022, the overall incidence was significantly lower, and no recorded median exceeded the interference threshold, whereas in 2023, this case occurred for the pure stands of Troll. In 2022, the reduction of the cereal leaf beetle’s incidence was more consistent but at a lower level, and in 2023, mixed cropping led to a relevant reduction of the incidence on the oat variety Troll (<strong>Figure 3</strong>) to levels below the interference threshold according to Swiss farming practices <span class="citation" data-cites="zotero-498">[@zotero-498]</span>.</p>
<div id="fig-des" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-des-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./writing/pictures/250507_combined_oulema_adj.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-des-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Cereal leaf beetle incidence (number of larvae per 10 flag leaves) in the years 2022 (top subfigure) and 2023 in the pure stands of the oat varieties (Bison, Lion, Troll) and in mixed cropping with the narrow-leaved lupin varieties (Lunabor, Probor, and Jowisz). The dashed lines indicate the interference threshold according to Swiss farming practices <span class="citation" data-cites="zotero-498">[@zotero-498]</span>. Each point represents one measurement.
</figcaption>
</figure>
</div>
<p>The dominant weed species (presence in over 33% of all scored plots) were wild mustard (<em>Sinapis arvensis</em>) in Reckenholz 2022, field poppy (<em>Papaver rhoeas</em>) in Reckenholz 2023, and cleavers <em>Galium aparine</em> in Seegräben in both years. The overall weed volumes were significantly lower in pure oat stands than in mixed oat stands, whereas the opposite held true for NLLs (p &lt; 0.05). The oat varieties Bison and Troll showed significant increases and all narrow-leaved lupin varieties showed significant decreases in mixed compared with pure stands (p &lt; 0.05), whereby the relative reduction in weed volume in mixed NLL treatments amounted to up to 83%. The relative increase of the recorded weed volumes in mixed oats was proportional to the relative decreases in mixed NLLs compared with their respective pure stands. The weed volume in pure stands of oats were two orders of magnitude lower than the weed volume in pure stands of NLLs (Figure 4).</p>
<div id="fig-des" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-des-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./writing/pictures/250507_weedvol_plot_adj.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-des-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Recorded weed volumes (log10 %) across both years 2022 and 2023 in the pure treatments of the three oat varieties (Bison, Lion, Troll) and narrow-leaved lupin varieties (Lunabor, Probor, and Jowisz) and their mixtures. Each point represents one measurement.
</figcaption>
</figure>
</div>
<div id="tbl-onfield" class="table-caption quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-onfield-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1
</figcaption>
<div aria-describedby="tbl-onfield-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<p>Effect size estimates of the linear mixed-effect models of the on-field response variables. The variety columns of the narrow-leaved lupins (Lunabor, Probor, Jowisz) and oats (Bison, Lion, Troll) refer to the change of the attribute in each variety in mixed stands compared with their respective pure stands. The year effect outlines the difference from year 2022 to the year 2023, and the Site_Re represents the difference of the site in Reckenholz to the site in Seegräben. No entry in the cell means there were no corresponding data, a zero means no significant effect could be detected. All non-zero numbers listed in the table stand for significant effects (adjusted p-value &lt; 0.05). BBCH represents the plant developmental stage.</p>
</div>
</figure>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 42%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th>Response (transformation, unit)</th>
<th>Lunabor</th>
<th>Probor</th>
<th>Jowisz</th>
<th>Bison</th>
<th>Lion</th>
<th>Troll</th>
<th>Year_2022</th>
<th>Site_Re</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Soil cover (-, days)</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>-19.8</td>
<td>-19.8</td>
<td>-19.8</td>
<td>-22</td>
<td>0</td>
</tr>
<tr class="even">
<td>Ears appearance in oat (-, days)</td>
<td></td>
<td></td>
<td></td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Height mid May lupin and oat (-, cm)</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>-9.9</td>
<td>-8.7</td>
<td>-6.6</td>
<td>8.4</td>
<td>0</td>
</tr>
<tr class="even">
<td>Cereal leaf beetle oat (sqrt, count)</td>
<td></td>
<td></td>
<td></td>
<td>0</td>
<td>-0.95</td>
<td>-1.1</td>
<td>-1.7</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Weed volume in lupin June (log10, %)</td>
<td>-0.65</td>
<td>-0.7</td>
<td>-0.89</td>
<td></td>
<td></td>
<td></td>
<td>-0.55</td>
<td>0</td>
</tr>
<tr class="even">
<td>Weed volume in oat June (log10, %)</td>
<td></td>
<td></td>
<td></td>
<td>0.75</td>
<td>0</td>
<td>0.73</td>
<td>-0.45</td>
<td>-0.5</td>
</tr>
<tr class="odd">
<td>BBCH at harvest (-, BBCH)</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>-2.4</td>
<td>-2.4</td>
<td>-2.4</td>
<td>3.1</td>
<td>0</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="productivity-and-quality-effects-of-mixed-cropping" class="level2">
<h2 class="anchored" data-anchor-id="productivity-and-quality-effects-of-mixed-cropping">Productivity and quality effects of mixed cropping</h2>
<section id="productivity-and-yield-stability" class="level3">
<h3 class="anchored" data-anchor-id="productivity-and-yield-stability">Productivity and yield stability</h3>
<p>The median NLL yields of Lunabor, Probor and Jowisz in pure stands were 3.1, 3.3 and 3.0 t ha-1, respectively. The median oat yields of Bison, Lion and Troll in pure stands amounted to 4.9, 5.4 and 5.2 t ha-1, respectively (Figure 5A). A significant year and site effect could be observed in both the NLL and oat yields: In 2022, the overall NLL yield was 0.96 t ha-1 higher, and the overall oat yield 0.36 t ha-1 lower than in 2023. Across both years, the site Reckenholz, compared with Seegräben, showed an overall reduction of the lupin yield by 1.1 thaha<sup>-1</sup> (p &lt; 0.01), whereas the overall oat yield was elevated by 0.75 thaha<sup>-1</sup> (p &lt; 0.01).</p>
<p>The land use efficiency of the studied mixtures showed the following picture: Across all nine mixtures, only Lunabor mixed with Troll exhibited a significantly elevated LER amounting to 1.16, i.e.&nbsp;this mixture used land 16% more efficiently than its corresponding pure stands. The LER of all other mixtures did not differ significantly from 1, which means their land use in pure stands was as efficient as in mixed stands. The partial LERs however showed a similar pattern as the partial protein overyielding: Across all mixtures, the partial LERs of the oats were significantly above their expected LER (corresponding to their sowing ratio) of 0.1 (p &lt; 0.001), with significantly different values between the three oat varieties in the decreasing order of Lion, Bison and Troll (p &lt; 0.001). The partial LER of the NLLs was significantly below their expected partial LER of 0.9 in case of the mixtures Jowisz x Bison, Jowisz x Lion and Probor x Lion (p &lt; 0.05), all other partial NLL LERs did not differ significantly from their expected value (Figure 5B). Again, a pronounced year effect was apparent for the partial LERs, where in 2022 the partial LER of NLLs was 0.16 higher and the partial LER of oats was 0.12 lower than in 2023 (p &lt; 0.001). The significant site effect manifested itself in a reduction of the partial LER of NLLs by 0.24 and an increase of the partial LER of oats by 0.13 in Reckenholz, compared with Seegräben (p &lt; 0.001). Altogether, these differences in the partial LERs resulted in a LER-change of -0.13 in Reckenholz compared with Seegräben (p &lt; 0.001), without a significant year effect.</p>
<p>The protein yield of pure stands was significantly higher in NLLs than in oats (p &lt; 0.001). The absolute protein yield of the two NLL varieties Probor and Jowisz was 275 kg ha-1 lower in mixed stands compared with pure stands (p &lt; 0.001), whereas Lunabor did not show any significant reduction. The total protein yield per hectare did not vary significantly between the three pure stands of the NLLs and all mixtures, adding up to 900 - 1150 kgha<sup>-1</sup> (Figure 5C). A strong site and year effect was also observed in case of the total protein yield of the NLLs: In 2023, the protein yield in Reckenholz was 262 kg ha<sup>-1</sup> lower than in Seegräben (p &lt; 0.0001), which also resulted in an overall increased protein yield in the year 2022 across both sites of 180 kgha<sup>-1</sup> (p &lt; 0.0001).</p>
<p>The linear mixed-effect models did not reveal any significant difference of the total protein overyielding from 1, which means no transgressive overyielding of protein could be observed, i.e.&nbsp;the protein yield per hectare was identical in mixed stands with the protein yield of pure NLL stands, which was the crop producing higher protein yields in pure stands. However, with regards to the expected partial protein overyielding, the oats exhibited higher partial overyielding, compared with their expected value of 0.1, corresponding to their sowing proportion of 10% (p &lt; 0.01). This effect was observed across all oat varieties and the measured median protein overyielding of oats amounted to 0.23. The NLLs protein overyielding of NLLs showed variable responses in comparison to their expected partial TOIprotein of 0.9: Lunabor in mixture with Bison, and all NLLs mixed with the oat variety Troll were not significantly different from the expected value, whereas the remaining 5 protein overyieldings of the NLLs were significantly lower than the expected value (p &lt; 0.05). Additionally, a significantly lower partial protein overyielding of Jowisz, compared to Lunabor could be observed (p &lt; 0.005) (Figure 5D).</p>
<div id="fig-des" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-des-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./writing/pictures/230320_mainplot.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-des-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Productivity overview of pure and mixed oat and narrow-leaved lupin stands. A: Yield, B: Partial and total land equivalent ratio, C: Protein yield, D: Partial and total protein overyielding. For all graphs, the median value is represented by the bar height, and the variability (median absolute deviation) by the whiskers. In mixed stands, the lower bar represents the partial lupin values, the upper bar the partial oat values and the whiskers refer to the variance of the individual components of either narrow-leaved lupins or oats. By definition, the transgressive protein overyielding(TOIprotein) and the land equivalent ratios (LER) are 1 in pure stands, represented by the dashed line.
</figcaption>
</figure>
</div>
<p>The outlined partial NLL and oat yields in the mixed treatments have shown opposite changes across both years and sites, i.e.** an overall decrease of one partial yield in one individual mixed treatment plot was accompanied by an increase in yield of the other crop.** This stabilising behaviour of the mixed cropping system This exemplifies the yield-stabilising behaviour of the mixed cropping system in comparison to their pure stands. The analysis of the stabilising behaviour showed a strong and highly significant correlation between the partial NLL and partial oat yields in mixture at a plot level (r = -0.73, p &lt; 0.001) (Figure 6).</p>
<div id="fig-des" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-des-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./writing/pictures/250507_yieldstability.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-des-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Yield stability: : Correlation between narrow-leaved lupin and oat yields on a plot level. The line indicates the trend with its 95% confidence interval (shaded area). Each dot represents the yield of the two crops recorded from one individual plot.
</figcaption>
</figure>
</div>
</section>
<section id="crop-quality" class="level3">
<h3 class="anchored" data-anchor-id="crop-quality">Crop quality</h3>
<p>The NLL grain quality remained unaffected by mixed cropping, as their protein content and thousand kernel weight (TKW) did not differ between the pure and the mixed stands. On the other hand, the oat grains exhibited strong mixed cropping responses, with an increase in their TKWs of 2.1 up to 4.1 g (p &lt; 0.001), compared to pure stands, representing a relative increase of up to 10%. Further, the oats hectolitre weight increased by 1.5 up to 1.9 kghl<sup>-1</sup>, compared with pure stands, representing a relative increase between 3 and 4% (p &lt; 0.05). In addition, compared with the pure stands, the oats protein content increased by 2.1 up to 3.3 % of the total weight, which corresponded to a relative increase of 27%, 21% and 31% for Bison, Lion and Troll, respectively (p &lt; 0.001). Across both years and sites, an overall reduction of 2.2% in the absolute protein content of the oats became apparent in Reckenholz in the year 2023 (p &lt; 0.001). The reported significant mixed cropping effects on yield quality are summarised in Table 5.</p>
<div id="tbl-offfield" class="table-caption quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-offfield-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2
</figcaption>
<div aria-describedby="tbl-offfield-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<p>Effect size estimates of the linear mixed-effect models of the crop quality data. The variety columns of the oats (Bison, Lion, Troll) refer to the change of the attribute in each variety in mixed stands compared with pure stands. The year effect outlines the difference from year 2022 to the year 2023, and the Site_Re represents the difference of the site in Reckenholz compared with the site in Seegräben. A zero entry in a cell means no significant effect could be detected. All non-zero numbers listed in the table stand for significant effects (adjusted p-value &lt; 0.05).</p>
</div>
</figure>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 45%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 13%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Response (unit)</th>
<th>Bison</th>
<th>Lion</th>
<th>Troll</th>
<th>Year_2022</th>
<th>Site_Re</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Hectolitre weight of oat (kg·hl<sup>-1</sup>)</td>
<td>1.5</td>
<td>1.8</td>
<td>1.9</td>
<td>-1.8</td>
<td>0</td>
</tr>
<tr class="even">
<td>Protein content of oat (%)</td>
<td>2.8</td>
<td>2.1</td>
<td>3.3</td>
<td>0.7</td>
<td>-2.2</td>
</tr>
<tr class="odd">
<td>Thousand kernel weight of oat (g)</td>
<td>4.1</td>
<td>2.9</td>
<td>2.1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>